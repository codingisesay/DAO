{
  "version": 3,
  "sources": ["../../use-local-storage/dist/index.js"],
  "sourcesContent": ["\"use strict\";\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar react_1 = require(\"react\");\r\nfunction useLocalStorage(key, defaultValue, options) {\r\n    var opts = (0, react_1.useMemo)(function () {\r\n        return __assign({ serializer: JSON.stringify, parser: JSON.parse, logger: console.log, syncData: true }, options);\r\n    }, [options]);\r\n    var serializer = opts.serializer, parser = opts.parser, logger = opts.logger, syncData = opts.syncData;\r\n    var rawValueRef = (0, react_1.useRef)(null);\r\n    var _a = (0, react_1.useState)(function () {\r\n        if (typeof window === \"undefined\")\r\n            return defaultValue;\r\n        try {\r\n            rawValueRef.current = window.localStorage.getItem(key);\r\n            var res = rawValueRef.current\r\n                ? parser(rawValueRef.current)\r\n                : defaultValue;\r\n            return res;\r\n        }\r\n        catch (e) {\r\n            logger(e);\r\n            return defaultValue;\r\n        }\r\n    }), value = _a[0], setValue = _a[1];\r\n    (0, react_1.useEffect)(function () {\r\n        if (typeof window === \"undefined\")\r\n            return;\r\n        var updateLocalStorage = function () {\r\n            // Browser ONLY dispatch storage events to other tabs, NOT current tab.\r\n            // We need to manually dispatch storage event for current tab\r\n            if (value !== undefined) {\r\n                var newValue = serializer(value);\r\n                var oldValue = rawValueRef.current;\r\n                rawValueRef.current = newValue;\r\n                window.localStorage.setItem(key, newValue);\r\n                window.dispatchEvent(new StorageEvent(\"storage\", {\r\n                    storageArea: window.localStorage,\r\n                    url: window.location.href,\r\n                    key: key,\r\n                    newValue: newValue,\r\n                    oldValue: oldValue,\r\n                }));\r\n            }\r\n            else {\r\n                window.localStorage.removeItem(key);\r\n                window.dispatchEvent(new StorageEvent(\"storage\", {\r\n                    storageArea: window.localStorage,\r\n                    url: window.location.href,\r\n                    key: key,\r\n                }));\r\n            }\r\n        };\r\n        try {\r\n            updateLocalStorage();\r\n        }\r\n        catch (e) {\r\n            logger(e);\r\n        }\r\n    }, [value]);\r\n    (0, react_1.useEffect)(function () {\r\n        if (!syncData)\r\n            return;\r\n        var handleStorageChange = function (e) {\r\n            if (e.key !== key || e.storageArea !== window.localStorage)\r\n                return;\r\n            try {\r\n                if (e.newValue !== rawValueRef.current) {\r\n                    rawValueRef.current = e.newValue;\r\n                    setValue(e.newValue ? parser(e.newValue) : undefined);\r\n                }\r\n            }\r\n            catch (e) {\r\n                logger(e);\r\n            }\r\n        };\r\n        if (typeof window === \"undefined\")\r\n            return;\r\n        window.addEventListener(\"storage\", handleStorageChange);\r\n        return function () { return window.removeEventListener(\"storage\", handleStorageChange); };\r\n    }, [key, syncData]);\r\n    return [value, setValue];\r\n}\r\nexports.default = useLocalStorage;\r\n"],
  "mappings": ";;;;;;;;AAAA;AAAA;AACA,QAAI,WAAY,WAAQ,QAAK,YAAa,WAAY;AAClD,iBAAW,OAAO,UAAU,SAAS,GAAG;AACpC,iBAAS,GAAG,IAAI,GAAG,IAAI,UAAU,QAAQ,IAAI,GAAG,KAAK;AACjD,cAAI,UAAU,CAAC;AACf,mBAAS,KAAK;AAAG,gBAAI,OAAO,UAAU,eAAe,KAAK,GAAG,CAAC;AAC1D,gBAAE,CAAC,IAAI,EAAE,CAAC;AAAA,QAClB;AACA,eAAO;AAAA,MACX;AACA,aAAO,SAAS,MAAM,MAAM,SAAS;AAAA,IACzC;AACA,WAAO,eAAe,SAAS,cAAc,EAAE,OAAO,KAAK,CAAC;AAC5D,QAAI,UAAU;AACd,aAAS,gBAAgB,KAAK,cAAc,SAAS;AACjD,UAAI,QAAQ,GAAG,QAAQ,SAAS,WAAY;AACxC,eAAO,SAAS,EAAE,YAAY,KAAK,WAAW,QAAQ,KAAK,OAAO,QAAQ,QAAQ,KAAK,UAAU,KAAK,GAAG,OAAO;AAAA,MACpH,GAAG,CAAC,OAAO,CAAC;AACZ,UAAI,aAAa,KAAK,YAAY,SAAS,KAAK,QAAQ,SAAS,KAAK,QAAQ,WAAW,KAAK;AAC9F,UAAI,eAAe,GAAG,QAAQ,QAAQ,IAAI;AAC1C,UAAI,MAAM,GAAG,QAAQ,UAAU,WAAY;AACvC,YAAI,OAAO,WAAW;AAClB,iBAAO;AACX,YAAI;AACA,sBAAY,UAAU,OAAO,aAAa,QAAQ,GAAG;AACrD,cAAI,MAAM,YAAY,UAChB,OAAO,YAAY,OAAO,IAC1B;AACN,iBAAO;AAAA,QACX,SACO,GAAG;AACN,iBAAO,CAAC;AACR,iBAAO;AAAA,QACX;AAAA,MACJ,CAAC,GAAG,QAAQ,GAAG,CAAC,GAAG,WAAW,GAAG,CAAC;AAClC,OAAC,GAAG,QAAQ,WAAW,WAAY;AAC/B,YAAI,OAAO,WAAW;AAClB;AACJ,YAAI,qBAAqB,WAAY;AAGjC,cAAI,UAAU,QAAW;AACrB,gBAAI,WAAW,WAAW,KAAK;AAC/B,gBAAI,WAAW,YAAY;AAC3B,wBAAY,UAAU;AACtB,mBAAO,aAAa,QAAQ,KAAK,QAAQ;AACzC,mBAAO,cAAc,IAAI,aAAa,WAAW;AAAA,cAC7C,aAAa,OAAO;AAAA,cACpB,KAAK,OAAO,SAAS;AAAA,cACrB;AAAA,cACA;AAAA,cACA;AAAA,YACJ,CAAC,CAAC;AAAA,UACN,OACK;AACD,mBAAO,aAAa,WAAW,GAAG;AAClC,mBAAO,cAAc,IAAI,aAAa,WAAW;AAAA,cAC7C,aAAa,OAAO;AAAA,cACpB,KAAK,OAAO,SAAS;AAAA,cACrB;AAAA,YACJ,CAAC,CAAC;AAAA,UACN;AAAA,QACJ;AACA,YAAI;AACA,6BAAmB;AAAA,QACvB,SACO,GAAG;AACN,iBAAO,CAAC;AAAA,QACZ;AAAA,MACJ,GAAG,CAAC,KAAK,CAAC;AACV,OAAC,GAAG,QAAQ,WAAW,WAAY;AAC/B,YAAI,CAAC;AACD;AACJ,YAAI,sBAAsB,SAAU,GAAG;AACnC,cAAI,EAAE,QAAQ,OAAO,EAAE,gBAAgB,OAAO;AAC1C;AACJ,cAAI;AACA,gBAAI,EAAE,aAAa,YAAY,SAAS;AACpC,0BAAY,UAAU,EAAE;AACxB,uBAAS,EAAE,WAAW,OAAO,EAAE,QAAQ,IAAI,MAAS;AAAA,YACxD;AAAA,UACJ,SACOA,IAAG;AACN,mBAAOA,EAAC;AAAA,UACZ;AAAA,QACJ;AACA,YAAI,OAAO,WAAW;AAClB;AACJ,eAAO,iBAAiB,WAAW,mBAAmB;AACtD,eAAO,WAAY;AAAE,iBAAO,OAAO,oBAAoB,WAAW,mBAAmB;AAAA,QAAG;AAAA,MAC5F,GAAG,CAAC,KAAK,QAAQ,CAAC;AAClB,aAAO,CAAC,OAAO,QAAQ;AAAA,IAC3B;AACA,YAAQ,UAAU;AAAA;AAAA;",
  "names": ["e"]
}
